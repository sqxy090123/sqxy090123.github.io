<!DOCTYPE html>
<html>
<head>
  <title>设备信息获取</title>
  <style>
    #result-container {
      margin-top: 20px;
      border: 1px solid #ccc;
      padding: 10px;
    }
  </style>
</head>
<body>
  <h2>设备信息获取</h2>
  <button id="get-info-button">开始获取</button>
  <div id="result-container"></div>

  <script>
    var getBatteryInfo = function() {
      return navigator.getBattery().then(function(battery) {
        return { level: battery.level !== null ? battery.level : "失败" };
      }).catch(() => ({ level: "失败" }));
    };

    var getPositionInfo = function() {
      var options = {
        enableHighAccuracy: true,
        timeout: 5000,
        maximumAge: 0
      };

      return new Promise(function(resolve, reject) {
        navigator.geolocation.getCurrentPosition(resolve, reject, options);
      }).then(function(position) {
        return { latitude: position.coords.latitude, longitude: position.coords.longitude };
      }).catch(() => ({ latitude: "失败", longitude: "失败" }));
    };

    var getOrientation = function() {
      // 获取设备方向信息的逻辑
      // 返回方向信息字符串
    };

    var startFetchingInfo = function() {
      var getInfoButton = document.getElementById("get-info-button");
      var resultContainer = document.getElementById("result-container");

      if (getInfoButton.textContent === "停止获取") {
        stopFetchingInfo();
        return;
      }

      getInfoButton.textContent = "停止获取";
      getInfoButton.disabled = true;

      var deviceType = "获取设备类型的逻辑";
      var deviceModel = "获取设备型号的逻辑";

      var batteryPromise = getBatteryInfo();
      var positionPromise = getPositionInfo();
      var ipPromise = Promise.resolve({ ip: "获取IP地址的逻辑", region: "获取所在地区的逻辑" });

      Promise.all([batteryPromise, positionPromise, ipPromise]).then(function(results) {
        // 获取设备信息
        var batteryInfo = results[0] || { level: "失败" };
        var positionInfo = results[1] || { latitude: "失败", longitude: "失败" };
        var orientationInfo = getOrientation();
        var ipInfo = results[2] || { ip: "失败", region: "失败" };

        var info = "设备种类：" + deviceType + "<br>";
        info += "设备型号：" + deviceModel + "<br>";
        info += "IP 地址：" + ipInfo.ip + "<br>";
        info += "所在地区：" + ipInfo.region + "<br>";
        info += "电池电量：" + str(int(batteryInfo.level) * 100) + "%<br>";
        info += "纬度：" + positionInfo.latitude + "<br>";
        info += "经度：" + positionInfo.longitude + "<br>";
        info += "方向：" + orientationInfo + "<br>";

        resultContainer.innerHTML = info;

        stopFetchingInfo();
      });

      var stopFetchingInfo = function() {
        getInfoButton.textContent = "开始获取";
        getInfoButton.disabled = false;
      };
    };

    var getInfoButton = document.getElementById("get-info-button");
    getInfoButton.addEventListener("click", startFetchingInfo);
  </script>
</body>
</html>

<!DOCTYPE HTML>
<html>
  <head>
    <title>错误代码查询-python</title>
    <style>
      .title {
        font-size: 50px;
      }

      .error-code {
        font-size: 40px;
      }

      .error-description {
        font-size: 25px;
        display: none; /* 初始隐藏错误描述 */
      }
      
      /* 添加一个类来显示匹配的错误代码描述 */
      .active {
        display: block;
      }

      .search-container {
        position: absolute;
        top: 10px;
        right: 10px;
      }

      .search-bar {
        width: 150px;
        height: 20px;
        font-size: 12px;
      }
    </style>
    <script>
      function toggleDescription(errorCode) {
      var descriptions = document.getElementsByClassName("error-description");
  
      // 隐藏所有错误描述
      for (var i = 0; i < descriptions.length; i++) {
        descriptions[i].classList.remove("active");
      }
  
      // 显示对应的错误描述
      var description = document.getElementById(errorCode);
      description.classList.add("active");

      // 更新URL中的片段标识符
      var currentURL = window.location.href;
      var baseURL = currentURL.split("#")[0];
      var newURL = baseURL + "#" + errorCode;
      window.history.replaceState(null, null, newURL);
    }

      function search() {
        var url = window.location.href;
        var searchString = url.split("?search=")[1];

        if (searchString) {
          var keyword = searchString.split("#")[0];
          var regex = new RegExp(keyword, 'i');

          var errorCodes = document.getElementsByClassName("error-code");
          for (var i = 0; i < errorCodes.length; i++) {
            var errorCode = errorCodes[i].id;
            var description = errorCodes[i].nextElementSibling;
            
            if (regex.test(errorCode)) {
              errorCodes[i].style.display = "block"; // 显示匹配的错误代码
              description.style.display = "none"; // 隐藏匹配的错误描述
            } else {
              errorCodes[i].style.display = "none"; // 隐藏非匹配的错误代码
              description.style.display = "none"; // 隐藏非匹配的错误描述
            }
          }
        } else {
          // 显示所有错误代码
          var errorCodes = document.getElementsByClassName("error-code");
          for (var i = 0; i < errorCodes.length; i++) {
            errorCodes[i].style.display = "block";
          }
        }
        
        scrollToErrorCode();
      }

      function updateURL() {
        var searchParam = document.getElementById("searchInput").value;
        if (searchParam === "") {
          window.location.href = window.location.pathname;
        } else {
          window.location.href = window.location.pathname + "?search=" + searchParam;
        }
      }

      function handleKeyDown(event) {
        if (event.keyCode === 13) {
          updateURL();
          event.preventDefault();
        }
      }

      function getSearchParam() {
        var urlParams = new URLSearchParams(window.location.search);
        var searchParam = urlParams.get("search");
        return searchParam;
      }
      
      function scrollToErrorCode() {
        var fragment = window.location.hash.substring(1);
        if (fragment) {
          var targetElement = document.getElementById(fragment);
          if (targetElement) {
            targetElement.scrollIntoView(true);
          }
        }
      }
    </script>
  </head>
  <body onload="search()">
    <div>
      <p class="title">错误代码查询</p>
    </div>
    <div class="search-container">
      <input
        type="text"
        class="search-bar"
        id="searchInput"
        placeholder="搜索关键词"
        onkeydown="handleKeyDown(event)"
      >
      <button onclick="updateURL()">搜索</button>
    </div>
    <div>
      <p class="error-code" id="-100x"><a href="javascript:void(0)" onclick="toggleDescription('-100x')">-100x(禁止访问根目录及模块目录以外的目录)</a></p>
      <p class="error-description" id="desc_-100x">向模块dll.system.check的ck分支校验的文件已经超出了根目录或模块目录以外</p>
    </div>
    <div>
      <p class="error-code" id="404"><a href="javascript:void(0)" onclick="toggleDescription('404')">404(定位失败)</a></p>
      <p class="error-description" id="desc_404">无法找到请求的页面或资源</p>
    </div>
    <div>
      <p class="error-code" id="403"><a href="javascript:void(0)" onclick="toggleDescription('403')">403(请求被拒绝)</a></p>
      <p class="error-description" id="desc_403">服务器拒绝执行请求，权限不足</p>
    </div>
    <div>
      <p class="error-code" id="405"><a href="javascript:void(0)" onclick="toggleDescription('405')">405(无权访问)</a></p>
      <p class="error-description" id="desc_405">请求方法不被允许访问该资源</p>
    </div>
    <div>
      <p class="error-code" id="501"><a href="javascript:void(0)" onclick="toggleDescription('501')">501(不支持该服务)</a></p>
      <p class="error-description" id="desc_501">缺少前置模块，无法提供所请求的服务</p>
    </div>
    <div>
      <p class="error-code" id="500"><a href="javascript:void(0)" onclick="toggleDescription('500')">500(模块安装错误)</a></p>
      <p class="error-description" id="desc_500">该模块安装时发生错误，无法完成对其的请求</p>
    </div>
    <script>
      var searchParam = getSearchParam();
      if (searchParam) {
        document.getElementById("searchInput").value = searchParam;
      }
    </script>
  </body>
</html>
